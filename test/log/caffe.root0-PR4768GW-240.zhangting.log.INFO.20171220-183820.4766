Log file created at: 2017/12/20 18:38:20
Running on machine: root0-PR4768GW-240
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
I1220 18:38:20.572505  4766 caffe.cpp:218] Using GPUs 6
I1220 18:38:20.713361  4766 caffe.cpp:223] GPU 6: GeForce GTX 1080 Ti
I1220 18:38:21.574165  4766 solver.cpp:44] Initializing solver from parameters: 
test_iter: 1
test_interval: 200
base_lr: 1e-05
display: 200
max_iter: 375000
lr_policy: "step"
gamma: 0.1
momentum: 0.9
weight_decay: 0.0001
stepsize: 125000
snapshot: 50000
snapshot_prefix: "./models/"
solver_mode: GPU
device_id: 6
net: "train_val.prototxt"
train_state {
  level: 0
  stage: ""
}
average_loss: 2000
I1220 18:38:21.574422  4766 solver.cpp:87] Creating training net from net file: train_val.prototxt
I1220 18:38:21.575320  4766 net.cpp:294] The NetState phase (0) differed from the phase (1) specified by a rule in layer crowd
I1220 18:38:21.575575  4766 net.cpp:51] Initializing net from parameters: 
name: "CrowdCount"
state {
  phase: TRAIN
  level: 0
  stage: ""
}
layer {
  name: "crowd"
  type: "CrowdData"
  top: "image"
  top: "dmap"
  include {
    phase: TRAIN
  }
  transform_param {
    scale: 1
  }
  image_data_param {
    source: "/home/zhangting/crowd_count/CWCC/CwCC_v2.0/test/crowd1_5_train.txt"
    batch_size: 1
    shuffle: false
    root_folder: "/ssd/wangmaorui/data/"
    downsamp_times: 2
    times_split: 0
    neighbor_num: 5
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "image"
  top: "conv1_1"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 64
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 64
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1_2"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1_2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv1_3"
  type: "Convolution"
  bottom: "pool1_2"
  top: "conv1_3"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 128
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_3"
  type: "ReLU"
  bottom: "conv1_3"
  top: "conv1_3"
}
layer {
  name: "conv1_4"
  type: "Convolution"
  bottom: "conv1_3"
  top: "conv1_4"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 128
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_4"
  type: "ReLU"
  bottom: "conv1_4"
  top: "conv1_4"
}
layer {
  name: "pool1_4"
  type: "Pooling"
  bottom: "conv1_4"
  top: "pool1_4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv1_5"
  type: "Convolution"
  bottom: "pool1_4"
  top: "conv1_5"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_5"
  type: "ReLU"
  bottom: "conv1_5"
  top: "conv1_5"
}
layer {
  name: "conv1_6"
  type: "Convolution"
  bottom: "conv1_5"
  top: "conv1_6"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_6"
  type: "ReLU"
  bottom: "conv1_6"
  top: "conv1_6"
}
layer {
  name: "conv"
  type: "Convolution"
  bottom: "conv1_6"
  top: "estdmap"
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "re_gtcount"
  type: "Reduction"
  bottom: "dmap"
  top: "gtcount"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_estcount"
  type: "Reduction"
  bottom: "estdmap"
  top: "estcount"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_estcount_1"
  type: "Reduction"
  bottom: "estdmap"
  top: "estcount_1"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_gtcount_1"
  type: "Reduction"
  bottom: "dmap"
  top: "gtcount_1"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "loss"
  type: "EuclideanLoss"
  bottom: "estdmap"
  bottom: "dmap"
  top: "loss"
}
layer {
  name: "loss2"
  type: "EuclideanLoss"
  bottom: "gtcount"
  bottom: "estcount"
  top: "loss2"
  loss_weight: 4e-05
}
I1220 18:38:21.575975  4766 layer_factory.hpp:77] Creating layer crowd
I1220 18:38:21.576028  4766 base_data_layer.cpp:41] prefetch_.size(): 4
I1220 18:38:21.576059  4766 net.cpp:84] Creating Layer crowd
I1220 18:38:21.576076  4766 net.cpp:380] crowd -> image
I1220 18:38:21.576117  4766 net.cpp:380] crowd -> dmap
I1220 18:38:21.766540  4766 crowd_data_layer.cpp:149] A total of 21182 crowd images.
I1220 18:38:21.786010  4766 net.cpp:122] Setting up crowd
I1220 18:38:21.786072  4766 net.cpp:129] Top shape: 1 3 128 128 (49152)
I1220 18:38:21.786115  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:21.786129  4766 net.cpp:137] Memory required for data: 200704
I1220 18:38:21.786175  4766 layer_factory.hpp:77] Creating layer dmap_crowd_1_split
I1220 18:38:21.786233  4766 net.cpp:84] Creating Layer dmap_crowd_1_split
I1220 18:38:21.786250  4766 net.cpp:406] dmap_crowd_1_split <- dmap
I1220 18:38:21.786283  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_0
I1220 18:38:21.786314  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_1
I1220 18:38:21.786335  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_2
I1220 18:38:21.786620  4766 net.cpp:122] Setting up dmap_crowd_1_split
I1220 18:38:21.786690  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:21.786703  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:21.786716  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:21.786727  4766 net.cpp:137] Memory required for data: 212992
I1220 18:38:21.786746  4766 layer_factory.hpp:77] Creating layer conv1_1
I1220 18:38:21.786909  4766 net.cpp:84] Creating Layer conv1_1
I1220 18:38:21.786924  4766 net.cpp:406] conv1_1 <- image
I1220 18:38:21.786944  4766 net.cpp:380] conv1_1 -> conv1_1
I1220 18:38:21.820773  4775 crowd_data_layer.cpp:268] dmp size before:176 , 316 , 
I1220 18:38:21.821290  4775 crowd_data_layer.cpp:280] dmp size after:174 , 314 , 
I1220 18:38:21.821307  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 696 , 1256 , 
I1220 18:38:21.856276  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 174 , 314 , 
I1220 18:38:21.885309  4775 crowd_data_layer.cpp:268] dmp size before:168 , 316 , 
I1220 18:38:21.885651  4775 crowd_data_layer.cpp:280] dmp size after:168 , 314 , 
I1220 18:38:21.885663  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 672 , 1256 , 
I1220 18:38:21.903961  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 168 , 314 , 
I1220 18:38:21.936424  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:21.936609  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:21.936619  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:21.952277  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:21.990330  4775 crowd_data_layer.cpp:268] dmp size before:164 , 320 , 
I1220 18:38:21.990595  4775 crowd_data_layer.cpp:280] dmp size after:162 , 318 , 
I1220 18:38:21.990604  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 648 , 1272 , 
I1220 18:38:22.099575  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 162 , 318 , 
I1220 18:38:22.872953  4766 net.cpp:122] Setting up conv1_1
I1220 18:38:22.873003  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:22.873009  4766 net.cpp:137] Memory required for data: 4407296
I1220 18:38:22.873033  4766 layer_factory.hpp:77] Creating layer relu1_1
I1220 18:38:22.873059  4766 net.cpp:84] Creating Layer relu1_1
I1220 18:38:22.873069  4766 net.cpp:406] relu1_1 <- conv1_1
I1220 18:38:22.873078  4766 net.cpp:367] relu1_1 -> conv1_1 (in-place)
I1220 18:38:22.874480  4766 net.cpp:122] Setting up relu1_1
I1220 18:38:22.874514  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:22.874524  4766 net.cpp:137] Memory required for data: 8601600
I1220 18:38:22.874538  4766 layer_factory.hpp:77] Creating layer conv1_2
I1220 18:38:22.874579  4766 net.cpp:84] Creating Layer conv1_2
I1220 18:38:22.874593  4766 net.cpp:406] conv1_2 <- conv1_1
I1220 18:38:22.874619  4766 net.cpp:380] conv1_2 -> conv1_2
I1220 18:38:22.886698  4766 net.cpp:122] Setting up conv1_2
I1220 18:38:22.886751  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:22.886762  4766 net.cpp:137] Memory required for data: 12795904
I1220 18:38:22.886787  4766 layer_factory.hpp:77] Creating layer relu1_2
I1220 18:38:22.886807  4766 net.cpp:84] Creating Layer relu1_2
I1220 18:38:22.886818  4766 net.cpp:406] relu1_2 <- conv1_2
I1220 18:38:22.886832  4766 net.cpp:367] relu1_2 -> conv1_2 (in-place)
I1220 18:38:22.887176  4766 net.cpp:122] Setting up relu1_2
I1220 18:38:22.887192  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:22.887200  4766 net.cpp:137] Memory required for data: 16990208
I1220 18:38:22.887209  4766 layer_factory.hpp:77] Creating layer pool1_2
I1220 18:38:22.887240  4766 net.cpp:84] Creating Layer pool1_2
I1220 18:38:22.887251  4766 net.cpp:406] pool1_2 <- conv1_2
I1220 18:38:22.887264  4766 net.cpp:380] pool1_2 -> pool1_2
I1220 18:38:22.887353  4766 net.cpp:122] Setting up pool1_2
I1220 18:38:22.887367  4766 net.cpp:129] Top shape: 1 64 64 64 (262144)
I1220 18:38:22.887374  4766 net.cpp:137] Memory required for data: 18038784
I1220 18:38:22.887390  4766 layer_factory.hpp:77] Creating layer conv1_3
I1220 18:38:22.887413  4766 net.cpp:84] Creating Layer conv1_3
I1220 18:38:22.887421  4766 net.cpp:406] conv1_3 <- pool1_2
I1220 18:38:22.887435  4766 net.cpp:380] conv1_3 -> conv1_3
I1220 18:38:22.900635  4766 net.cpp:122] Setting up conv1_3
I1220 18:38:22.900662  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:22.900669  4766 net.cpp:137] Memory required for data: 20135936
I1220 18:38:22.900686  4766 layer_factory.hpp:77] Creating layer relu1_3
I1220 18:38:22.900703  4766 net.cpp:84] Creating Layer relu1_3
I1220 18:38:22.900712  4766 net.cpp:406] relu1_3 <- conv1_3
I1220 18:38:22.900723  4766 net.cpp:367] relu1_3 -> conv1_3 (in-place)
I1220 18:38:22.901062  4766 net.cpp:122] Setting up relu1_3
I1220 18:38:22.901077  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:22.901083  4766 net.cpp:137] Memory required for data: 22233088
I1220 18:38:22.901089  4766 layer_factory.hpp:77] Creating layer conv1_4
I1220 18:38:22.901118  4766 net.cpp:84] Creating Layer conv1_4
I1220 18:38:22.901126  4766 net.cpp:406] conv1_4 <- conv1_3
I1220 18:38:22.901139  4766 net.cpp:380] conv1_4 -> conv1_4
I1220 18:38:22.921262  4766 net.cpp:122] Setting up conv1_4
I1220 18:38:22.921286  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:22.921294  4766 net.cpp:137] Memory required for data: 24330240
I1220 18:38:22.921308  4766 layer_factory.hpp:77] Creating layer relu1_4
I1220 18:38:22.921319  4766 net.cpp:84] Creating Layer relu1_4
I1220 18:38:22.921326  4766 net.cpp:406] relu1_4 <- conv1_4
I1220 18:38:22.921336  4766 net.cpp:367] relu1_4 -> conv1_4 (in-place)
I1220 18:38:22.922621  4766 net.cpp:122] Setting up relu1_4
I1220 18:38:22.922644  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:22.922652  4766 net.cpp:137] Memory required for data: 26427392
I1220 18:38:22.922669  4766 layer_factory.hpp:77] Creating layer pool1_4
I1220 18:38:22.922689  4766 net.cpp:84] Creating Layer pool1_4
I1220 18:38:22.922737  4766 net.cpp:406] pool1_4 <- conv1_4
I1220 18:38:22.922750  4766 net.cpp:380] pool1_4 -> pool1_4
I1220 18:38:22.922819  4766 net.cpp:122] Setting up pool1_4
I1220 18:38:22.922830  4766 net.cpp:129] Top shape: 1 128 32 32 (131072)
I1220 18:38:22.922837  4766 net.cpp:137] Memory required for data: 26951680
I1220 18:38:22.922843  4766 layer_factory.hpp:77] Creating layer conv1_5
I1220 18:38:22.922860  4766 net.cpp:84] Creating Layer conv1_5
I1220 18:38:22.922868  4766 net.cpp:406] conv1_5 <- pool1_4
I1220 18:38:22.922879  4766 net.cpp:380] conv1_5 -> conv1_5
I1220 18:38:22.949764  4766 net.cpp:122] Setting up conv1_5
I1220 18:38:22.949803  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:22.949815  4766 net.cpp:137] Memory required for data: 28000256
I1220 18:38:22.949864  4766 layer_factory.hpp:77] Creating layer relu1_5
I1220 18:38:22.949883  4766 net.cpp:84] Creating Layer relu1_5
I1220 18:38:22.949895  4766 net.cpp:406] relu1_5 <- conv1_5
I1220 18:38:22.949910  4766 net.cpp:367] relu1_5 -> conv1_5 (in-place)
I1220 18:38:22.950234  4766 net.cpp:122] Setting up relu1_5
I1220 18:38:22.950248  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:22.950254  4766 net.cpp:137] Memory required for data: 29048832
I1220 18:38:22.950271  4766 layer_factory.hpp:77] Creating layer conv1_6
I1220 18:38:22.950294  4766 net.cpp:84] Creating Layer conv1_6
I1220 18:38:22.950302  4766 net.cpp:406] conv1_6 <- conv1_5
I1220 18:38:22.950314  4766 net.cpp:380] conv1_6 -> conv1_6
I1220 18:38:22.998287  4766 net.cpp:122] Setting up conv1_6
I1220 18:38:22.998339  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:22.998356  4766 net.cpp:137] Memory required for data: 30097408
I1220 18:38:22.998378  4766 layer_factory.hpp:77] Creating layer relu1_6
I1220 18:38:22.998401  4766 net.cpp:84] Creating Layer relu1_6
I1220 18:38:22.998415  4766 net.cpp:406] relu1_6 <- conv1_6
I1220 18:38:22.998433  4766 net.cpp:367] relu1_6 -> conv1_6 (in-place)
I1220 18:38:22.998849  4766 net.cpp:122] Setting up relu1_6
I1220 18:38:22.998872  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:22.998883  4766 net.cpp:137] Memory required for data: 31145984
I1220 18:38:22.998894  4766 layer_factory.hpp:77] Creating layer conv
I1220 18:38:22.998925  4766 net.cpp:84] Creating Layer conv
I1220 18:38:22.998937  4766 net.cpp:406] conv <- conv1_6
I1220 18:38:22.998955  4766 net.cpp:380] conv -> estdmap
I1220 18:38:23.001821  4766 net.cpp:122] Setting up conv
I1220 18:38:23.001870  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.001885  4766 net.cpp:137] Memory required for data: 31150080
I1220 18:38:23.001904  4766 layer_factory.hpp:77] Creating layer estdmap_conv_0_split
I1220 18:38:23.001921  4766 net.cpp:84] Creating Layer estdmap_conv_0_split
I1220 18:38:23.001932  4766 net.cpp:406] estdmap_conv_0_split <- estdmap
I1220 18:38:23.001948  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_0
I1220 18:38:23.001966  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_1
I1220 18:38:23.001982  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_2
I1220 18:38:23.002081  4766 net.cpp:122] Setting up estdmap_conv_0_split
I1220 18:38:23.002097  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.002111  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.002128  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.002138  4766 net.cpp:137] Memory required for data: 31162368
I1220 18:38:23.002149  4766 layer_factory.hpp:77] Creating layer re_gtcount
I1220 18:38:23.002184  4766 net.cpp:84] Creating Layer re_gtcount
I1220 18:38:23.002195  4766 net.cpp:406] re_gtcount <- dmap_crowd_1_split_0
I1220 18:38:23.002213  4766 net.cpp:380] re_gtcount -> gtcount
I1220 18:38:23.002305  4766 net.cpp:122] Setting up re_gtcount
I1220 18:38:23.002321  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.002331  4766 net.cpp:137] Memory required for data: 31162372
I1220 18:38:23.002342  4766 layer_factory.hpp:77] Creating layer re_estcount
I1220 18:38:23.002406  4766 net.cpp:84] Creating Layer re_estcount
I1220 18:38:23.002418  4766 net.cpp:406] re_estcount <- estdmap_conv_0_split_0
I1220 18:38:23.002435  4766 net.cpp:380] re_estcount -> estcount
I1220 18:38:23.002522  4766 net.cpp:122] Setting up re_estcount
I1220 18:38:23.002537  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.002547  4766 net.cpp:137] Memory required for data: 31162376
I1220 18:38:23.002559  4766 layer_factory.hpp:77] Creating layer re_estcount_1
I1220 18:38:23.002573  4766 net.cpp:84] Creating Layer re_estcount_1
I1220 18:38:23.002583  4766 net.cpp:406] re_estcount_1 <- estdmap_conv_0_split_1
I1220 18:38:23.002598  4766 net.cpp:380] re_estcount_1 -> estcount_1
I1220 18:38:23.002676  4766 net.cpp:122] Setting up re_estcount_1
I1220 18:38:23.002691  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.002701  4766 net.cpp:137] Memory required for data: 31162380
I1220 18:38:23.002712  4766 layer_factory.hpp:77] Creating layer re_gtcount_1
I1220 18:38:23.002727  4766 net.cpp:84] Creating Layer re_gtcount_1
I1220 18:38:23.002737  4766 net.cpp:406] re_gtcount_1 <- dmap_crowd_1_split_1
I1220 18:38:23.002750  4766 net.cpp:380] re_gtcount_1 -> gtcount_1
I1220 18:38:23.002827  4766 net.cpp:122] Setting up re_gtcount_1
I1220 18:38:23.002841  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.002851  4766 net.cpp:137] Memory required for data: 31162384
I1220 18:38:23.002861  4766 layer_factory.hpp:77] Creating layer loss
I1220 18:38:23.002888  4766 net.cpp:84] Creating Layer loss
I1220 18:38:23.002899  4766 net.cpp:406] loss <- estdmap_conv_0_split_2
I1220 18:38:23.002912  4766 net.cpp:406] loss <- dmap_crowd_1_split_2
I1220 18:38:23.002925  4766 net.cpp:380] loss -> loss
I1220 18:38:23.003008  4766 net.cpp:122] Setting up loss
I1220 18:38:23.003022  4766 net.cpp:129] Top shape: (1)
I1220 18:38:23.003032  4766 net.cpp:132]     with loss weight 1
I1220 18:38:23.003062  4766 net.cpp:137] Memory required for data: 31162388
I1220 18:38:23.003073  4766 layer_factory.hpp:77] Creating layer loss2
I1220 18:38:23.003088  4766 net.cpp:84] Creating Layer loss2
I1220 18:38:23.003098  4766 net.cpp:406] loss2 <- gtcount
I1220 18:38:23.003110  4766 net.cpp:406] loss2 <- estcount
I1220 18:38:23.003123  4766 net.cpp:380] loss2 -> loss2
I1220 18:38:23.003188  4766 net.cpp:122] Setting up loss2
I1220 18:38:23.003201  4766 net.cpp:129] Top shape: (1)
I1220 18:38:23.003211  4766 net.cpp:132]     with loss weight 4e-05
I1220 18:38:23.003224  4766 net.cpp:137] Memory required for data: 31162392
I1220 18:38:23.003234  4766 net.cpp:198] loss2 needs backward computation.
I1220 18:38:23.003247  4766 net.cpp:198] loss needs backward computation.
I1220 18:38:23.003258  4766 net.cpp:200] re_gtcount_1 does not need backward computation.
I1220 18:38:23.003268  4766 net.cpp:200] re_estcount_1 does not need backward computation.
I1220 18:38:23.003279  4766 net.cpp:198] re_estcount needs backward computation.
I1220 18:38:23.003289  4766 net.cpp:200] re_gtcount does not need backward computation.
I1220 18:38:23.003300  4766 net.cpp:198] estdmap_conv_0_split needs backward computation.
I1220 18:38:23.003310  4766 net.cpp:198] conv needs backward computation.
I1220 18:38:23.003321  4766 net.cpp:198] relu1_6 needs backward computation.
I1220 18:38:23.003330  4766 net.cpp:198] conv1_6 needs backward computation.
I1220 18:38:23.003341  4766 net.cpp:198] relu1_5 needs backward computation.
I1220 18:38:23.003350  4766 net.cpp:198] conv1_5 needs backward computation.
I1220 18:38:23.003361  4766 net.cpp:198] pool1_4 needs backward computation.
I1220 18:38:23.003371  4766 net.cpp:198] relu1_4 needs backward computation.
I1220 18:38:23.003381  4766 net.cpp:198] conv1_4 needs backward computation.
I1220 18:38:23.003391  4766 net.cpp:198] relu1_3 needs backward computation.
I1220 18:38:23.003401  4766 net.cpp:198] conv1_3 needs backward computation.
I1220 18:38:23.003412  4766 net.cpp:198] pool1_2 needs backward computation.
I1220 18:38:23.003422  4766 net.cpp:198] relu1_2 needs backward computation.
I1220 18:38:23.003432  4766 net.cpp:198] conv1_2 needs backward computation.
I1220 18:38:23.003459  4766 net.cpp:198] relu1_1 needs backward computation.
I1220 18:38:23.003471  4766 net.cpp:198] conv1_1 needs backward computation.
I1220 18:38:23.003484  4766 net.cpp:200] dmap_crowd_1_split does not need backward computation.
I1220 18:38:23.003494  4766 net.cpp:200] crowd does not need backward computation.
I1220 18:38:23.003504  4766 net.cpp:242] This network produces output estcount_1
I1220 18:38:23.003515  4766 net.cpp:242] This network produces output gtcount_1
I1220 18:38:23.003525  4766 net.cpp:242] This network produces output loss
I1220 18:38:23.003535  4766 net.cpp:242] This network produces output loss2
I1220 18:38:23.003571  4766 net.cpp:255] Network initialization done.
I1220 18:38:23.004817  4766 solver.cpp:172] Creating test net (#0) specified by net file: train_val.prototxt
I1220 18:38:23.004890  4766 net.cpp:294] The NetState phase (1) differed from the phase (0) specified by a rule in layer crowd
I1220 18:38:23.005144  4766 net.cpp:51] Initializing net from parameters: 
name: "CrowdCount"
state {
  phase: TEST
}
layer {
  name: "crowd"
  type: "CrowdData"
  top: "image"
  top: "dmap"
  include {
    phase: TEST
  }
  transform_param {
    scale: 1
  }
  image_data_param {
    source: "/home/zhangting/crowd_count/CWCC/CwCC_v2.0/test/crowd1_5_train.txt"
    batch_size: 1
    shuffle: false
    root_folder: "/ssd/wangmaorui/data/"
    downsamp_times: 2
    times_split: 0
    neighbor_num: 5
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "image"
  top: "conv1_1"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 64
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 64
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1_2"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1_2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv1_3"
  type: "Convolution"
  bottom: "pool1_2"
  top: "conv1_3"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 128
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_3"
  type: "ReLU"
  bottom: "conv1_3"
  top: "conv1_3"
}
layer {
  name: "conv1_4"
  type: "Convolution"
  bottom: "conv1_3"
  top: "conv1_4"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 128
    pad: 2
    kernel_size: 5
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_4"
  type: "ReLU"
  bottom: "conv1_4"
  top: "conv1_4"
}
layer {
  name: "pool1_4"
  type: "Pooling"
  bottom: "conv1_4"
  top: "pool1_4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv1_5"
  type: "Convolution"
  bottom: "pool1_4"
  top: "conv1_5"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_5"
  type: "ReLU"
  bottom: "conv1_5"
  top: "conv1_5"
}
layer {
  name: "conv1_6"
  type: "Convolution"
  bottom: "conv1_5"
  top: "conv1_6"
  param {
    lr_mult: 1
  }
  param {
    lr_mult: 2
  }
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    stride: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
    bias_filler {
      type: "constant"
      value: 0
    }
  }
}
layer {
  name: "relu1_6"
  type: "ReLU"
  bottom: "conv1_6"
  top: "conv1_6"
}
layer {
  name: "conv"
  type: "Convolution"
  bottom: "conv1_6"
  top: "estdmap"
  convolution_param {
    num_output: 1
    kernel_size: 1
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "re_gtcount"
  type: "Reduction"
  bottom: "dmap"
  top: "gtcount"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_estcount"
  type: "Reduction"
  bottom: "estdmap"
  top: "estcount"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_estcount_1"
  type: "Reduction"
  bottom: "estdmap"
  top: "estcount_1"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "re_gtcount_1"
  type: "Reduction"
  bottom: "dmap"
  top: "gtcount_1"
  reduction_param {
    axis: 1
  }
}
layer {
  name: "loss"
  type: "EuclideanLoss"
  bottom: "estdmap"
  bottom: "dmap"
  top: "loss"
}
layer {
  name: "loss2"
  type: "EuclideanLoss"
  bottom: "gtcount"
  bottom: "estcount"
  top: "loss2"
  loss_weight: 4e-05
}
I1220 18:38:23.005769  4766 layer_factory.hpp:77] Creating layer crowd
I1220 18:38:23.005795  4766 base_data_layer.cpp:41] prefetch_.size(): 4
I1220 18:38:23.005807  4766 net.cpp:84] Creating Layer crowd
I1220 18:38:23.005817  4766 net.cpp:380] crowd -> image
I1220 18:38:23.005833  4766 net.cpp:380] crowd -> dmap
I1220 18:38:23.195850  4766 crowd_data_layer.cpp:149] A total of 21182 crowd images.
I1220 18:38:23.205018  4766 net.cpp:122] Setting up crowd
I1220 18:38:23.205041  4766 net.cpp:129] Top shape: 1 3 128 128 (49152)
I1220 18:38:23.205049  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.205052  4766 net.cpp:137] Memory required for data: 200704
I1220 18:38:23.205061  4766 layer_factory.hpp:77] Creating layer dmap_crowd_1_split
I1220 18:38:23.205086  4766 net.cpp:84] Creating Layer dmap_crowd_1_split
I1220 18:38:23.205096  4766 net.cpp:406] dmap_crowd_1_split <- dmap
I1220 18:38:23.205111  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_0
I1220 18:38:23.205129  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_1
I1220 18:38:23.205142  4766 net.cpp:380] dmap_crowd_1_split -> dmap_crowd_1_split_2
I1220 18:38:23.205545  4766 net.cpp:122] Setting up dmap_crowd_1_split
I1220 18:38:23.205605  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.205621  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.205632  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.205642  4766 net.cpp:137] Memory required for data: 212992
I1220 18:38:23.205655  4766 layer_factory.hpp:77] Creating layer conv1_1
I1220 18:38:23.205693  4766 net.cpp:84] Creating Layer conv1_1
I1220 18:38:23.205706  4766 net.cpp:406] conv1_1 <- image
I1220 18:38:23.205726  4766 net.cpp:380] conv1_1 -> conv1_1
I1220 18:38:23.210211  4766 net.cpp:122] Setting up conv1_1
I1220 18:38:23.210245  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:23.210258  4766 net.cpp:137] Memory required for data: 4407296
I1220 18:38:23.210286  4766 layer_factory.hpp:77] Creating layer relu1_1
I1220 18:38:23.210305  4766 net.cpp:84] Creating Layer relu1_1
I1220 18:38:23.210316  4766 net.cpp:406] relu1_1 <- conv1_1
I1220 18:38:23.210331  4766 net.cpp:367] relu1_1 -> conv1_1 (in-place)
I1220 18:38:23.212158  4766 net.cpp:122] Setting up relu1_1
I1220 18:38:23.212190  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:23.212201  4766 net.cpp:137] Memory required for data: 8601600
I1220 18:38:23.212213  4766 layer_factory.hpp:77] Creating layer conv1_2
I1220 18:38:23.212242  4766 net.cpp:84] Creating Layer conv1_2
I1220 18:38:23.212255  4766 net.cpp:406] conv1_2 <- conv1_1
I1220 18:38:23.212272  4766 net.cpp:380] conv1_2 -> conv1_2
I1220 18:38:23.221455  4766 net.cpp:122] Setting up conv1_2
I1220 18:38:23.221487  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:23.221539  4766 net.cpp:137] Memory required for data: 12795904
I1220 18:38:23.221562  4766 layer_factory.hpp:77] Creating layer relu1_2
I1220 18:38:23.221580  4766 net.cpp:84] Creating Layer relu1_2
I1220 18:38:23.221591  4766 net.cpp:406] relu1_2 <- conv1_2
I1220 18:38:23.221606  4766 net.cpp:367] relu1_2 -> conv1_2 (in-place)
I1220 18:38:23.222079  4766 net.cpp:122] Setting up relu1_2
I1220 18:38:23.222100  4766 net.cpp:129] Top shape: 1 64 128 128 (1048576)
I1220 18:38:23.222108  4766 net.cpp:137] Memory required for data: 16990208
I1220 18:38:23.222118  4766 layer_factory.hpp:77] Creating layer pool1_2
I1220 18:38:23.222136  4766 net.cpp:84] Creating Layer pool1_2
I1220 18:38:23.222146  4766 net.cpp:406] pool1_2 <- conv1_2
I1220 18:38:23.222162  4766 net.cpp:380] pool1_2 -> pool1_2
I1220 18:38:23.222249  4766 net.cpp:122] Setting up pool1_2
I1220 18:38:23.222263  4766 net.cpp:129] Top shape: 1 64 64 64 (262144)
I1220 18:38:23.222272  4766 net.cpp:137] Memory required for data: 18038784
I1220 18:38:23.222281  4766 layer_factory.hpp:77] Creating layer conv1_3
I1220 18:38:23.222304  4766 net.cpp:84] Creating Layer conv1_3
I1220 18:38:23.222316  4766 net.cpp:406] conv1_3 <- pool1_2
I1220 18:38:23.222332  4766 net.cpp:380] conv1_3 -> conv1_3
I1220 18:38:23.236333  4766 net.cpp:122] Setting up conv1_3
I1220 18:38:23.236363  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:23.236374  4766 net.cpp:137] Memory required for data: 20135936
I1220 18:38:23.236397  4766 layer_factory.hpp:77] Creating layer relu1_3
I1220 18:38:23.236414  4766 net.cpp:84] Creating Layer relu1_3
I1220 18:38:23.236424  4766 net.cpp:406] relu1_3 <- conv1_3
I1220 18:38:23.236439  4766 net.cpp:367] relu1_3 -> conv1_3 (in-place)
I1220 18:38:23.236876  4766 net.cpp:122] Setting up relu1_3
I1220 18:38:23.236894  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:23.236903  4766 net.cpp:137] Memory required for data: 22233088
I1220 18:38:23.236912  4766 layer_factory.hpp:77] Creating layer conv1_4
I1220 18:38:23.236935  4766 net.cpp:84] Creating Layer conv1_4
I1220 18:38:23.236945  4766 net.cpp:406] conv1_4 <- conv1_3
I1220 18:38:23.236963  4766 net.cpp:380] conv1_4 -> conv1_4
I1220 18:38:23.240068  4777 crowd_data_layer.cpp:268] dmp size before:176 , 316 , 
I1220 18:38:23.240466  4777 crowd_data_layer.cpp:280] dmp size after:174 , 314 , 
I1220 18:38:23.240483  4777 crowd_data_layer.cpp:283] img shape 1 , 3 , 696 , 1256 , 
I1220 18:38:23.265570  4766 net.cpp:122] Setting up conv1_4
I1220 18:38:23.265594  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:23.265602  4766 net.cpp:137] Memory required for data: 24330240
I1220 18:38:23.265616  4766 layer_factory.hpp:77] Creating layer relu1_4
I1220 18:38:23.265630  4766 net.cpp:84] Creating Layer relu1_4
I1220 18:38:23.265638  4766 net.cpp:406] relu1_4 <- conv1_4
I1220 18:38:23.265648  4766 net.cpp:367] relu1_4 -> conv1_4 (in-place)
I1220 18:38:23.266341  4777 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 174 , 314 , 
I1220 18:38:23.267477  4766 net.cpp:122] Setting up relu1_4
I1220 18:38:23.267514  4766 net.cpp:129] Top shape: 1 128 64 64 (524288)
I1220 18:38:23.267526  4766 net.cpp:137] Memory required for data: 26427392
I1220 18:38:23.267537  4766 layer_factory.hpp:77] Creating layer pool1_4
I1220 18:38:23.267558  4766 net.cpp:84] Creating Layer pool1_4
I1220 18:38:23.267572  4766 net.cpp:406] pool1_4 <- conv1_4
I1220 18:38:23.267590  4766 net.cpp:380] pool1_4 -> pool1_4
I1220 18:38:23.269937  4766 net.cpp:122] Setting up pool1_4
I1220 18:38:23.269973  4766 net.cpp:129] Top shape: 1 128 32 32 (131072)
I1220 18:38:23.269984  4766 net.cpp:137] Memory required for data: 26951680
I1220 18:38:23.269994  4766 layer_factory.hpp:77] Creating layer conv1_5
I1220 18:38:23.270022  4766 net.cpp:84] Creating Layer conv1_5
I1220 18:38:23.270033  4766 net.cpp:406] conv1_5 <- pool1_4
I1220 18:38:23.270051  4766 net.cpp:380] conv1_5 -> conv1_5
I1220 18:38:23.291139  4777 crowd_data_layer.cpp:268] dmp size before:168 , 316 , 
I1220 18:38:23.291455  4777 crowd_data_layer.cpp:280] dmp size after:168 , 314 , 
I1220 18:38:23.291499  4777 crowd_data_layer.cpp:283] img shape 1 , 3 , 672 , 1256 , 
I1220 18:38:23.300612  4766 net.cpp:122] Setting up conv1_5
I1220 18:38:23.300644  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:23.300654  4766 net.cpp:137] Memory required for data: 28000256
I1220 18:38:23.300680  4766 layer_factory.hpp:77] Creating layer relu1_5
I1220 18:38:23.300699  4766 net.cpp:84] Creating Layer relu1_5
I1220 18:38:23.300709  4766 net.cpp:406] relu1_5 <- conv1_5
I1220 18:38:23.300722  4766 net.cpp:367] relu1_5 -> conv1_5 (in-place)
I1220 18:38:23.301174  4766 net.cpp:122] Setting up relu1_5
I1220 18:38:23.301193  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:23.301201  4766 net.cpp:137] Memory required for data: 29048832
I1220 18:38:23.301210  4766 layer_factory.hpp:77] Creating layer conv1_6
I1220 18:38:23.301234  4766 net.cpp:84] Creating Layer conv1_6
I1220 18:38:23.301244  4766 net.cpp:406] conv1_6 <- conv1_5
I1220 18:38:23.301260  4766 net.cpp:380] conv1_6 -> conv1_6
I1220 18:38:23.308555  4777 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 168 , 314 , 
I1220 18:38:23.334280  4766 net.cpp:122] Setting up conv1_6
I1220 18:38:23.334306  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:23.334316  4766 net.cpp:137] Memory required for data: 30097408
I1220 18:38:23.334331  4766 layer_factory.hpp:77] Creating layer relu1_6
I1220 18:38:23.334344  4766 net.cpp:84] Creating Layer relu1_6
I1220 18:38:23.334352  4766 net.cpp:406] relu1_6 <- conv1_6
I1220 18:38:23.334365  4766 net.cpp:367] relu1_6 -> conv1_6 (in-place)
I1220 18:38:23.334764  4766 net.cpp:122] Setting up relu1_6
I1220 18:38:23.334779  4766 net.cpp:129] Top shape: 1 256 32 32 (262144)
I1220 18:38:23.334786  4766 net.cpp:137] Memory required for data: 31145984
I1220 18:38:23.334794  4766 layer_factory.hpp:77] Creating layer conv
I1220 18:38:23.334817  4766 net.cpp:84] Creating Layer conv
I1220 18:38:23.334826  4766 net.cpp:406] conv <- conv1_6
I1220 18:38:23.334841  4766 net.cpp:380] conv -> estdmap
I1220 18:38:23.337491  4766 net.cpp:122] Setting up conv
I1220 18:38:23.337517  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.337524  4766 net.cpp:137] Memory required for data: 31150080
I1220 18:38:23.337538  4766 layer_factory.hpp:77] Creating layer estdmap_conv_0_split
I1220 18:38:23.337563  4766 net.cpp:84] Creating Layer estdmap_conv_0_split
I1220 18:38:23.337571  4766 net.cpp:406] estdmap_conv_0_split <- estdmap
I1220 18:38:23.337584  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_0
I1220 18:38:23.337599  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_1
I1220 18:38:23.337611  4766 net.cpp:380] estdmap_conv_0_split -> estdmap_conv_0_split_2
I1220 18:38:23.337709  4766 net.cpp:122] Setting up estdmap_conv_0_split
I1220 18:38:23.337721  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.337730  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.337740  4766 net.cpp:129] Top shape: 1 1 32 32 (1024)
I1220 18:38:23.337748  4766 net.cpp:137] Memory required for data: 31162368
I1220 18:38:23.337755  4766 layer_factory.hpp:77] Creating layer re_gtcount
I1220 18:38:23.337769  4766 net.cpp:84] Creating Layer re_gtcount
I1220 18:38:23.337777  4766 net.cpp:406] re_gtcount <- dmap_crowd_1_split_0
I1220 18:38:23.337790  4766 net.cpp:380] re_gtcount -> gtcount
I1220 18:38:23.337895  4766 net.cpp:122] Setting up re_gtcount
I1220 18:38:23.337908  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.337914  4766 net.cpp:137] Memory required for data: 31162372
I1220 18:38:23.337923  4766 layer_factory.hpp:77] Creating layer re_estcount
I1220 18:38:23.337934  4766 net.cpp:84] Creating Layer re_estcount
I1220 18:38:23.337944  4766 net.cpp:406] re_estcount <- estdmap_conv_0_split_0
I1220 18:38:23.337956  4766 net.cpp:380] re_estcount -> estcount
I1220 18:38:23.338033  4766 net.cpp:122] Setting up re_estcount
I1220 18:38:23.338043  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.338063  4766 net.cpp:137] Memory required for data: 31162376
I1220 18:38:23.338096  4766 layer_factory.hpp:77] Creating layer re_estcount_1
I1220 18:38:23.338109  4766 net.cpp:84] Creating Layer re_estcount_1
I1220 18:38:23.338117  4766 net.cpp:406] re_estcount_1 <- estdmap_conv_0_split_1
I1220 18:38:23.338130  4766 net.cpp:380] re_estcount_1 -> estcount_1
I1220 18:38:23.338209  4766 net.cpp:122] Setting up re_estcount_1
I1220 18:38:23.338219  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.338227  4766 net.cpp:137] Memory required for data: 31162380
I1220 18:38:23.338234  4766 layer_factory.hpp:77] Creating layer re_gtcount_1
I1220 18:38:23.338246  4766 net.cpp:84] Creating Layer re_gtcount_1
I1220 18:38:23.338254  4766 net.cpp:406] re_gtcount_1 <- dmap_crowd_1_split_1
I1220 18:38:23.338266  4766 net.cpp:380] re_gtcount_1 -> gtcount_1
I1220 18:38:23.338338  4766 net.cpp:122] Setting up re_gtcount_1
I1220 18:38:23.338348  4766 net.cpp:129] Top shape: 1 (1)
I1220 18:38:23.338354  4766 net.cpp:137] Memory required for data: 31162384
I1220 18:38:23.338361  4766 layer_factory.hpp:77] Creating layer loss
I1220 18:38:23.338374  4766 net.cpp:84] Creating Layer loss
I1220 18:38:23.338382  4766 net.cpp:406] loss <- estdmap_conv_0_split_2
I1220 18:38:23.338392  4766 net.cpp:406] loss <- dmap_crowd_1_split_2
I1220 18:38:23.338402  4766 net.cpp:380] loss -> loss
I1220 18:38:23.338462  4766 net.cpp:122] Setting up loss
I1220 18:38:23.338472  4766 net.cpp:129] Top shape: (1)
I1220 18:38:23.338479  4766 net.cpp:132]     with loss weight 1
I1220 18:38:23.338495  4766 net.cpp:137] Memory required for data: 31162388
I1220 18:38:23.338501  4766 layer_factory.hpp:77] Creating layer loss2
I1220 18:38:23.338515  4766 net.cpp:84] Creating Layer loss2
I1220 18:38:23.338521  4766 net.cpp:406] loss2 <- gtcount
I1220 18:38:23.338531  4766 net.cpp:406] loss2 <- estcount
I1220 18:38:23.338541  4766 net.cpp:380] loss2 -> loss2
I1220 18:38:23.338599  4766 net.cpp:122] Setting up loss2
I1220 18:38:23.338608  4766 net.cpp:129] Top shape: (1)
I1220 18:38:23.338615  4766 net.cpp:132]     with loss weight 4e-05
I1220 18:38:23.338625  4766 net.cpp:137] Memory required for data: 31162392
I1220 18:38:23.338634  4766 net.cpp:198] loss2 needs backward computation.
I1220 18:38:23.338641  4766 net.cpp:198] loss needs backward computation.
I1220 18:38:23.338649  4766 net.cpp:200] re_gtcount_1 does not need backward computation.
I1220 18:38:23.338657  4766 net.cpp:200] re_estcount_1 does not need backward computation.
I1220 18:38:23.338665  4766 net.cpp:198] re_estcount needs backward computation.
I1220 18:38:23.338672  4766 net.cpp:200] re_gtcount does not need backward computation.
I1220 18:38:23.338680  4766 net.cpp:198] estdmap_conv_0_split needs backward computation.
I1220 18:38:23.338687  4766 net.cpp:198] conv needs backward computation.
I1220 18:38:23.338695  4766 net.cpp:198] relu1_6 needs backward computation.
I1220 18:38:23.338701  4766 net.cpp:198] conv1_6 needs backward computation.
I1220 18:38:23.338708  4766 net.cpp:198] relu1_5 needs backward computation.
I1220 18:38:23.338716  4766 net.cpp:198] conv1_5 needs backward computation.
I1220 18:38:23.338723  4766 net.cpp:198] pool1_4 needs backward computation.
I1220 18:38:23.338731  4766 net.cpp:198] relu1_4 needs backward computation.
I1220 18:38:23.338738  4766 net.cpp:198] conv1_4 needs backward computation.
I1220 18:38:23.338745  4766 net.cpp:198] relu1_3 needs backward computation.
I1220 18:38:23.338752  4766 net.cpp:198] conv1_3 needs backward computation.
I1220 18:38:23.338760  4766 net.cpp:198] pool1_2 needs backward computation.
I1220 18:38:23.338768  4766 net.cpp:198] relu1_2 needs backward computation.
I1220 18:38:23.338775  4766 net.cpp:198] conv1_2 needs backward computation.
I1220 18:38:23.338783  4766 net.cpp:198] relu1_1 needs backward computation.
I1220 18:38:23.338789  4766 net.cpp:198] conv1_1 needs backward computation.
I1220 18:38:23.338798  4766 net.cpp:200] dmap_crowd_1_split does not need backward computation.
I1220 18:38:23.338807  4766 net.cpp:200] crowd does not need backward computation.
I1220 18:38:23.338814  4766 net.cpp:242] This network produces output estcount_1
I1220 18:38:23.338836  4766 net.cpp:242] This network produces output gtcount_1
I1220 18:38:23.338845  4766 net.cpp:242] This network produces output loss
I1220 18:38:23.338855  4766 net.cpp:242] This network produces output loss2
I1220 18:38:23.338888  4766 net.cpp:255] Network initialization done.
I1220 18:38:23.339038  4766 solver.cpp:56] Solver scaffolding done.
I1220 18:38:23.340057  4766 caffe.cpp:248] Starting Optimization
I1220 18:38:23.340070  4766 solver.cpp:272] Solving CrowdCount
I1220 18:38:23.340076  4766 solver.cpp:273] Learning Rate Policy: step
I1220 18:38:23.342595  4766 solver.cpp:330] Iteration 0, Testing net (#0)
I1220 18:38:23.351119  4777 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:23.351358  4777 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:23.351371  4777 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:23.372767  4777 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:23.423127  4777 crowd_data_layer.cpp:268] dmp size before:164 , 320 , 
I1220 18:38:23.423411  4777 crowd_data_layer.cpp:280] dmp size after:162 , 318 , 
I1220 18:38:23.423421  4777 crowd_data_layer.cpp:283] img shape 1 , 3 , 648 , 1272 , 
I1220 18:38:23.453491  4777 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 162 , 318 , 
I1220 18:38:23.483232  4766 solver.cpp:397]     Test net output #0: estcount_1 = 174.379
I1220 18:38:23.483289  4766 solver.cpp:397]     Test net output #1: gtcount_1 = 0.98221
I1220 18:38:23.483323  4766 solver.cpp:397]     Test net output #2: loss = 0.333359 (* 1 = 0.333359 loss)
I1220 18:38:23.483345  4766 solver.cpp:397]     Test net output #3: loss2 = 15033.3 (* 4e-05 = 0.60133 loss)
I1220 18:38:23.501519  4777 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:23.501783  4777 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:23.501796  4777 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:23.524636  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:23.524879  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:23.524893  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:23.530612  4777 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:23.576088  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:23.884639  4766 solver.cpp:218] Iteration 0 (-2.40769e+06 iter/s, 0.544479s/200 iters), loss = 0.93469
I1220 18:38:23.884697  4766 solver.cpp:237]     Train net output #0: estcount_1 = 174.379
I1220 18:38:23.884706  4766 solver.cpp:237]     Train net output #1: gtcount_1 = 0.98221
I1220 18:38:23.884717  4766 solver.cpp:237]     Train net output #2: loss = 0.333359 (* 1 = 0.333359 loss)
I1220 18:38:23.884732  4766 solver.cpp:237]     Train net output #3: loss2 = 15033.3 (* 4e-05 = 0.60133 loss)
I1220 18:38:23.884765  4766 sgd_solver.cpp:105] Iteration 0, lr = 1e-05
I1220 18:38:23.918467  4775 crowd_data_layer.cpp:268] dmp size before:164 , 316 , 
I1220 18:38:23.918851  4775 crowd_data_layer.cpp:280] dmp size after:164 , 314 , 
I1220 18:38:23.918867  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 656 , 1256 , 
I1220 18:38:23.931162  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 164 , 314 , 
I1220 18:38:24.204592  4775 crowd_data_layer.cpp:268] dmp size before:172 , 316 , 
I1220 18:38:24.204996  4775 crowd_data_layer.cpp:280] dmp size after:170 , 316 , 
I1220 18:38:24.205009  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 680 , 1264 , 
I1220 18:38:24.217847  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 170 , 316 , 
I1220 18:38:24.558676  4775 crowd_data_layer.cpp:268] dmp size before:172 , 316 , 
I1220 18:38:24.559075  4775 crowd_data_layer.cpp:280] dmp size after:170 , 316 , 
I1220 18:38:24.559088  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 680 , 1264 , 
I1220 18:38:24.610883  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 170 , 316 , 
I1220 18:38:24.828914  4775 crowd_data_layer.cpp:268] dmp size before:140 , 312 , 
I1220 18:38:24.829190  4775 crowd_data_layer.cpp:280] dmp size after:140 , 310 , 
I1220 18:38:24.829200  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 560 , 1240 , 
I1220 18:38:24.835719  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 140 , 310 , 
I1220 18:38:25.149389  4775 crowd_data_layer.cpp:268] dmp size before:168 , 316 , 
I1220 18:38:25.149786  4775 crowd_data_layer.cpp:280] dmp size after:166 , 316 , 
I1220 18:38:25.149799  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 664 , 1264 , 
I1220 18:38:25.162537  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 166 , 316 , 
I1220 18:38:25.421649  4775 crowd_data_layer.cpp:268] dmp size before:128 , 312 , 
I1220 18:38:25.421885  4775 crowd_data_layer.cpp:280] dmp size after:128 , 312 , 
I1220 18:38:25.421900  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 512 , 1248 , 
I1220 18:38:25.431674  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 128 , 312 , 
I1220 18:38:25.710453  4775 crowd_data_layer.cpp:268] dmp size before:144 , 316 , 
I1220 18:38:25.710700  4775 crowd_data_layer.cpp:280] dmp size after:144 , 316 , 
I1220 18:38:25.710712  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 576 , 1264 , 
I1220 18:38:25.721982  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 144 , 316 , 
I1220 18:38:26.021657  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:26.021971  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:26.021986  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:26.031543  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:26.228246  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:26.228423  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:26.228432  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:26.299819  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:26.519191  4775 crowd_data_layer.cpp:268] dmp size before:164 , 236 , 
I1220 18:38:26.519407  4775 crowd_data_layer.cpp:280] dmp size after:162 , 236 , 
I1220 18:38:26.519415  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 651 , 944 , 
I1220 18:38:26.525015  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 162 , 236 , 
I1220 18:38:26.755408  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:26.755702  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:26.755715  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
I1220 18:38:26.798481  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
I1220 18:38:26.992314  4775 crowd_data_layer.cpp:268] dmp size before:172 , 320 , 
I1220 18:38:26.993119  4775 crowd_data_layer.cpp:280] dmp size after:172 , 318 , 
I1220 18:38:26.993144  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 688 , 1272 , 
I1220 18:38:27.001933  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 172 , 318 , 
I1220 18:38:27.295935  4775 crowd_data_layer.cpp:268] dmp size before:140 , 256 , 
I1220 18:38:27.296263  4775 crowd_data_layer.cpp:280] dmp size after:138 , 254 , 
I1220 18:38:27.296278  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 552 , 1016 , 
I1220 18:38:27.305321  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 138 , 254 , 
I1220 18:38:27.617255  4775 crowd_data_layer.cpp:268] dmp size before:180 , 320 , 
I1220 18:38:27.617543  4775 crowd_data_layer.cpp:280] dmp size after:180 , 320 , 
I1220 18:38:27.617557  4775 crowd_data_layer.cpp:283] img shape 1 , 3 , 720 , 1280 , 
F1220 18:38:27.627662  4766 euclidean_loss_layer.cpp:12] Check failed: bottom[0]->count(1) == bottom[1]->count(1) (38468 vs. 38232) Inputs must have the same dimension.
I1220 18:38:27.631161  4775 crowd_data_layer.cpp:299] dmp shape 1 , 1 , 180 , 320 , 
